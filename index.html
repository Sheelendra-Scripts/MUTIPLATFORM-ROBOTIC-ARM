<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Robotic Arm Controller</title>
    <style>
        /* --- Basic reset and layout --- */
        *{box-sizing:border-box;margin:0;padding:0}
        body{
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
            background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
            min-height:100vh;padding:18px;color:#333;
        }
        .container{
            max-width:1200px;margin:0 auto;background:rgba(255,255,255,0.96);
            border-radius:18px;padding:26px;box-shadow:0 20px 40px rgba(0,0,0,0.12);
            backdrop-filter: blur(6px);
        }
        .header{text-align:center;margin-bottom:18px}
        .header h1{color:#2c3e50;font-size:2rem;margin-bottom:8px}
        .header p{color:#586573;font-size:0.95rem}

        /* --- Connection panel --- */
        .connection-panel{
            background:#34495e;color:white;padding:16px;border-radius:12px;margin-bottom:18px;
            display:flex;flex-wrap:wrap;align-items:center;gap:10px;justify-content:space-between;
        }
        .left, .right { display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
        .btn{
            background:linear-gradient(45deg,#3498db,#2980b9);color:white;border:none;padding:10px 16px;border-radius:20px;
            cursor:pointer;font-size:14px;box-shadow:0 4px 12px rgba(0,0,0,0.12);
        }
        .btn:disabled{opacity:0.5;cursor:not-allowed}
        .btn-success{background:linear-gradient(45deg,#27ae60,#219a52)}
        .btn-danger{background:linear-gradient(45deg,#e74c3c,#c0392b)}
        .btn-warning{background:linear-gradient(45deg,#f39c12,#e67e22)}
        .status{display:inline-block;padding:8px 14px;border-radius:20px;font-weight:700}
        .status.disconnected{background:#e74c3c;color:white}
        .status.connected{background:#27ae60;color:white}

        /* --- Controls grid --- */
        .controls-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:18px;margin:18px 0}
        .servo-control{background:white;border-radius:12px;padding:18px;border:2px solid #ecf0f1;box-shadow:0 8px 20px rgba(0,0,0,0.06)}
        .servo-label{font-weight:700;color:#2c3e50;margin-bottom:10px;text-align:center}
        .slider{width:100%;height:8px;border-radius:6px;background:#ecf0f1;appearance:none;outline:none}
        .slider::-webkit-slider-thumb{appearance:none;width:20px;height:20px;border-radius:50%;background:linear-gradient(45deg,#3498db,#2980b9);cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,0.18)}
        .value-display{display:flex;justify-content:space-between;align-items:center;margin-top:10px}
        .current-value{background:#3498db;color:white;padding:6px 12px;border-radius:14px;font-weight:700;min-width:54px;text-align:center}
        .preset-buttons{display:flex;gap:8px;flex-wrap:wrap}
        .preset-btn{background:#95a5a6;color:white;border:none;padding:6px 10px;border-radius:10px;cursor:pointer;font-size:13px}
        .preset-btn:disabled{opacity:0.5;cursor:not-allowed}

        /* --- Speed & system controls --- */
        .speed-control{background:white;border-radius:12px;padding:14px;border:2px solid #ecf0f1;text-align:center;margin-bottom:12px}
        .speed-slider{width:200px;height:8px}
        .system-controls{display:flex;gap:12px;flex-wrap:wrap;justify-content:center;margin-bottom:12px}

        /* --- Logs --- */
        .log-panel{background:#2c3e50;color:#ecf0f1;border-radius:10px;padding:12px;height:160px;overflow-y:auto;font-family:monospace;font-size:13px}
        .log-entry{margin-bottom:6px}
        .log-sent{color:#82c0ff}
        .log-received{color:#9be6a7}
        .log-error{color:#ffb3b3}
        .note{font-size:12px;color:#7f8c8d;margin-top:8px;text-align:center}

        @media (max-width:700px){
            .connection-panel{flex-direction:column;align-items:stretch;gap:8px}
            .left,.right{justify-content:center}
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤– Robotic Arm Controller</h1>
            <p>Combined Bluetooth (BLE) + USB Serial interface â€” single-file, mobile-friendly UI</p>
        </div>

        <div class="connection-panel" role="region" aria-label="connection panel">
            <div class="left">
                <button class="btn" id="btnConnectBT">ğŸ“± Connect Bluetooth</button>
                <button class="btn" id="btnConnectSerial">ğŸ”Œ Connect USB Serial</button>
                <button class="btn btn-success" id="btnArmConnect">âœ… Connect Arm</button>
                <button class="btn btn-danger" id="btnArmDisconnect">âŒ Disconnect Arm</button>
            </div>

            <div class="right">
                <span id="status" class="status disconnected">Disconnected</span>
                <div class="note">ğŸ’¡ Note: HC-05 (classic SPP) often won't work with Web Bluetooth â€” use USB Serial or a phone terminal app if needed.</div>
            </div>
        </div>

        <div class="controls-grid" id="controlsGrid">
            <!-- Joint 1 -->
            <div class="servo-control">
                <div class="servo-label">Joint 1 - Base Rotation</div>
                <input type="range" min="0" max="180" value="0" class="slider" id="servo0" data-index="1">
                <div class="value-display">
                    <span id="value0" class="current-value">0Â°</span>
                    <div class="preset-buttons">
                        <button class="preset-btn" data-servo="0" data-val="0">0Â°</button>
                        <button class="preset-btn" data-servo="0" data-val="45">45Â°</button>
                        <button class="preset-btn" data-servo="0" data-val="90">90Â°</button>
                        <button class="preset-btn" data-servo="0" data-val="135">135Â°</button>
                        <button class="preset-btn" data-servo="0" data-val="180">180Â°</button>
                    </div>
                </div>
            </div>

            <!-- Joint 2 -->
            <div class="servo-control">
                <div class="servo-label">Joint 2 - Shoulder</div>
                <input type="range" min="0" max="180" value="90" class="slider" id="servo1" data-index="2">
                <div class="value-display">
                    <span id="value1" class="current-value">90Â°</span>
                    <div class="preset-buttons">
                        <button class="preset-btn" data-servo="1" data-val="0">0Â°</button>
                        <button class="preset-btn" data-servo="1" data-val="45">45Â°</button>
                        <button class="preset-btn" data-servo="1" data-val="90">90Â°</button>
                        <button class="preset-btn" data-servo="1" data-val="135">135Â°</button>
                        <button class="preset-btn" data-servo="1" data-val="180">180Â°</button>
                    </div>
                </div>
            </div>

            <!-- Joint 3 -->
            <div class="servo-control">
                <div class="servo-label">Joint 3 - Elbow</div>
                <input type="range" min="0" max="180" value="90" class="slider" id="servo2" data-index="3">
                <div class="value-display">
                    <span id="value2" class="current-value">90Â°</span>
                    <div class="preset-buttons">
                        <button class="preset-btn" data-servo="2" data-val="0">0Â°</button>
                        <button class="preset-btn" data-servo="2" data-val="45">45Â°</button>
                        <button class="preset-btn" data-servo="2" data-val="90">90Â°</button>
                        <button class="preset-btn" data-servo="2" data-val="135">135Â°</button>
                        <button class="preset-btn" data-servo="2" data-val="180">180Â°</button>
                    </div>
                </div>
            </div>

            <!-- Joint 4 -->
            <div class="servo-control">
                <div class="servo-label">Joint 4 - Wrist Pitch</div>
                <input type="range" min="0" max="180" value="90" class="slider" id="servo3" data-index="4">
                <div class="value-display">
                    <span id="value3" class="current-value">90Â°</span>
                    <div class="preset-buttons">
                        <button class="preset-btn" data-servo="3" data-val="0">0Â°</button>
                        <button class="preset-btn" data-servo="3" data-val="45">45Â°</button>
                        <button class="preset-btn" data-servo="3" data-val="90">90Â°</button>
                        <button class="preset-btn" data-servo="3" data-val="135">135Â°</button>
                        <button class="preset-btn" data-servo="3" data-val="180">180Â°</button>
                    </div>
                </div>
            </div>

            <!-- Joint 5 -->
            <div class="servo-control">
                <div class="servo-label">Joint 5 - Wrist Roll</div>
                <input type="range" min="0" max="180" value="90" class="slider" id="servo4" data-index="5">
                <div class="value-display">
                    <span id="value4" class="current-value">90Â°</span>
                    <div class="preset-buttons">
                        <button class="preset-btn" data-servo="4" data-val="0">0Â°</button>
                        <button class="preset-btn" data-servo="4" data-val="45">45Â°</button>
                        <button class="preset-btn" data-servo="4" data-val="90">90Â°</button>
                        <button class="preset-btn" data-servo="4" data-val="135">135Â°</button>
                        <button class="preset-btn" data-servo="4" data-val="180">180Â°</button>
                    </div>
                </div>
            </div>

            <!-- Joint 6 - Gripper: restricted to 90..180 -->
            <div class="servo-control">
                <div class="servo-label">Joint 6 - Gripper (range: 90Â° â€” 180Â°)</div>
                <!-- NOTE: slider range set to 90..180 per your request -->
                <input type="range" min="90" max="180" value="90" class="slider" id="servo5" data-index="6">
                <div class="value-display">
                    <span id="value5" class="current-value">90Â°</span>
                    <div class="preset-buttons">
                        <!-- Mapping: Close = 90, Half = 135, Open = 180.
                             You asked for Half=45 but also requested the slider stay 90..180.
                             45 is outside that range, so I've used 135 as the midpoint/half. -->
                        <button class="preset-btn" data-servo="5" data-val="90">Close (90Â°)</button>
                        <button class="preset-btn" data-servo="5" data-val="135">Half (135Â°)</button>
                        <button class="preset-btn" data-servo="5" data-val="180">Open (180Â°)</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="speed-control">
            <h3 style="margin-bottom:8px">Movement Speed</h3>
            <input type="range" min="1" max="100" value="50" class="slider speed-slider" id="speedSlider">
            <div style="margin-top:10px">
                <span id="speedValue" class="current-value">50</span>
            </div>
        </div>

        <div class="system-controls">
            <button class="btn btn-warning" id="btnSave">ğŸ’¾ Save Position</button>
            <button class="btn btn-success" id="btnRun">â–¶ï¸ Run Saved</button>
            <button class="btn" id="btnReset">ğŸ”„ Reset to Home</button>
            <button class="btn btn-warning" id="btnPause">â¸ï¸ Pause</button>
            <button class="btn btn-success" id="btnResume">â¯ï¸ Resume</button>
        </div>

        <div class="log-panel" id="logPanel" aria-live="polite">
            <div class="log-entry">ğŸ¤– Robotic Arm Controller Ready</div>
            <div class="log-entry">ğŸ“± For BLE: use devices that support Web Bluetooth (BLE). Classic HC-05 often not compatible with WebBluetooth.</div>
            <div class="log-entry">ğŸ”Œ For USB serial: Chrome/Edge required (Web Serial API)</div>
        </div>
    </div>

    <script>
        /******************************************************************
         * Single-file combined BLE + Web Serial controller
         * - Commands: s{servoIndex}{position}  (servoIndex: 1..6)
         * - Speed: ss{speed}
         ******************************************************************/

        // ===== Global state =====
        let bluetoothDevice = null;
        let bluetoothCharacteristic = null; // writable char
        let serialPort = null;
        let serialReader = null;
        let connectedVia = null; // "ble" | "serial" | null
        let isArmConnected = false;

        // DOM
        const logPanel = document.getElementById('logPanel');
        const statusEl = document.getElementById('status');
        const btnConnectBT = document.getElementById('btnConnectBT');
        const btnConnectSerial = document.getElementById('btnConnectSerial');
        const btnArmConnect = document.getElementById('btnArmConnect');
        const btnArmDisconnect = document.getElementById('btnArmDisconnect');
        const controlsGrid = document.getElementById('controlsGrid');

        // Utility: add log
        function addLog(message, type='info') {
            const e = document.createElement('div');
            e.className = 'log-entry';
            if (type === 'sent') e.classList.add('log-sent');
            if (type === 'received') e.classList.add('log-received');
            if (type === 'error') e.classList.add('log-error');

            const timestamp = new Date().toLocaleTimeString();
            e.textContent = `${timestamp} â€” ${message}`;
            logPanel.appendChild(e);
            logPanel.scrollTop = logPanel.scrollHeight;
        }

        // ===== Connection status UI =====
        function updateConnectionStatus() {
            if (connectedVia && isArmConnected) {
                statusEl.textContent = `Connected (${connectedVia.toUpperCase()})`;
                statusEl.className = 'status connected';
                setControlsEnabled(true);
            } else if (connectedVia) {
                statusEl.textContent = `Link Ready (${connectedVia.toUpperCase()})`;
                statusEl.className = 'status connected';
                setControlsEnabled(false);
            } else {
                statusEl.textContent = 'Disconnected';
                statusEl.className = 'status disconnected';
                setControlsEnabled(false);
            }
        }

        // Enable/disable all interactive controls (except connect buttons)
        function setControlsEnabled(enabled) {
            // sliders, preset buttons, system control buttons, speed
            const sl = document.querySelectorAll('.slider');
            sl.forEach(s => s.disabled = !enabled);

            const pbs = document.querySelectorAll('.preset-btn');
            pbs.forEach(b => b.disabled = !enabled);

            const sysBtns = document.querySelectorAll('.system-controls .btn, .system-controls .btn-warning, .system-controls .btn-success, .system-controls .btn-danger');
            // above selector may not find system-controls inside the tree; simpler:
            document.getElementById('btnSave').disabled = !enabled;
            document.getElementById('btnRun').disabled = !enabled;
            document.getElementById('btnReset').disabled = !enabled;
            document.getElementById('btnPause').disabled = !enabled;
            document.getElementById('btnResume').disabled = !enabled;

            // Keep connect buttons enabled always
            btnConnectBT.disabled = false;
            btnConnectSerial.disabled = false;
            btnArmConnect.disabled = !connectedVia; // only enable arm connect if link exists
            btnArmDisconnect.disabled = !isArmConnected;
        }

        // ===== BLE (Web Bluetooth) =====
        async function connectBluetooth() {
            if (!('bluetooth' in navigator)) {
                addLog('Web Bluetooth API not supported in this browser.', 'error');
                return;
            }

            try {
                addLog('Requesting Bluetooth device...');
                // Accept all devices; we will attempt to find a writable characteristic
                bluetoothDevice = await navigator.bluetooth.requestDevice({ 
                    acceptAllDevices: true, 
                    optionalServices: ['00001800-0000-1000-8000-00805f9b34fb'] 
                });
                bluetoothDevice.addEventListener('gattserverdisconnected', onBleDisconnected);

                addLog(`Connecting to GATT server (${bluetoothDevice.name || 'Unknown'})...`);
                const server = await bluetoothDevice.gatt.connect();

                addLog('Discovering services...');
                const services = await server.getPrimaryServices();

                addLog(`Found ${services.length} service(s), searching for writable characteristic...`);
                // Try to find any writable characteristic
                for (const svc of services) {
                    try {
                        const chars = await svc.getCharacteristics();
                        for (const ch of chars) {
                            if (ch.properties.write || ch.properties.writeWithoutResponse) {
                                bluetoothCharacteristic = ch;
                                addLog('Writable characteristic found. BLE link ready.', 'received');
                                connectedVia = 'ble';
                                updateConnectionStatus();
                                return;
                            }
                        }
                    } catch (e) {
                        // ignore and continue
                    }
                }

                addLog('No writable characteristic found on the device. BLE may not be SPP-compatible.', 'error');
                // disconnect if nothing usable
                if (bluetoothDevice.gatt.connected) bluetoothDevice.gatt.disconnect();
                bluetoothDevice = null;
                bluetoothCharacteristic = null;
                connectedVia = null;
                updateConnectionStatus();
            } catch (err) {
                addLog(`Bluetooth connect failed: ${err.message}`, 'error');
                bluetoothDevice = null;
                bluetoothCharacteristic = null;
                connectedVia = null;
                updateConnectionStatus();
            }
        }

        function onBleDisconnected() {
            addLog('BLE device disconnected', 'error');
            bluetoothDevice = null;
            bluetoothCharacteristic = null;
            if (connectedVia === 'ble') connectedVia = null;
            isArmConnected = false;
            updateConnectionStatus();
        }

        // ===== Web Serial (USB) =====
        async function connectSerial() {
            if (!('serial' in navigator)) {
                addLog('Web Serial API not supported in this browser. Use Chrome/Edge.', 'error');
                return;
            }

            try {
                addLog('Requesting serial port...');
                serialPort = await navigator.serial.requestPort();
                await serialPort.open({ baudRate: 9600, dataBits: 8, stopBits: 1, parity: 'none' });
                addLog('Serial port opened.', 'received');
                connectedVia = 'serial';
                startSerialReader();
                updateConnectionStatus();
            } catch (err) {
                addLog(`Serial connection failed: ${err.message}`, 'error');
                serialPort = null;
                connectedVia = null;
                updateConnectionStatus();
            }
        }

        async function startSerialReader() {
            if (!serialPort || !serialPort.readable) return;
            try {
                serialReader = serialPort.readable.getReader();
                let buffer = '';
                const decoder = new TextDecoder();
                while (true) {
                    const { value, done } = await serialReader.read();
                    if (done) break;
                    if (value) {
                        const chunk = decoder.decode(value);
                        buffer += chunk;
                        let idx;
                        while ((idx = buffer.indexOf('\n')) !== -1) {
                            const line = buffer.slice(0, idx).trim();
                            buffer = buffer.slice(idx + 1);
                            if (line) {
                                addLog(`Received: ${line}`, 'received');
                                // handle "Connected" messages from microcontroller
                                if (line.includes('Connected')) {
                                    isArmConnected = true;
                                } else if (line.includes('Disconnected')) {
                                    isArmConnected = false;
                                }
                                updateConnectionStatus();
                            }
                        }
                    }
                }
            } catch (err) {
                if (err.name !== 'AbortError') addLog(`Serial read error: ${err.message}`, 'error');
            } finally {
                try { serialReader.releaseLock(); } catch (e){}
            }
        }

        async function disconnectSerial() {
            try {
                if (serialReader) {
                    await serialReader.cancel();
                    serialReader = null;
                }
                if (serialPort) {
                    await serialPort.close();
                    serialPort = null;
                }
                addLog('Serial port closed.', 'info');
            } catch (err) {
                addLog(`Error closing serial: ${err.message}`, 'error');
            } finally {
                if (connectedVia === 'serial') connectedVia = null;
                isArmConnected = false;
                updateConnectionStatus();
            }
        }

        // ===== Shared send command logic =====
        // Always append newline. We try BLE first, then Serial.
        async function sendCommand(command) {
            const payload = command + '\n';
            const encoder = new TextEncoder();

            if (!connectedVia) {
                addLog('No transport available. Connect Bluetooth or USB Serial first.', 'error');
                return;
            }

            try {
                if (connectedVia === 'ble' && bluetoothCharacteristic) {
                    // BLE characteristic write expects ArrayBuffer
                    await bluetoothCharacteristic.writeValue(encoder.encode(payload));
                    addLog(`Sent via BLE: ${command}`, 'sent');
                } else if (connectedVia === 'serial' && serialPort && serialPort.writable) {
                    const writer = serialPort.writable.getWriter();
                    await writer.write(encoder.encode(payload));
                    writer.releaseLock();
                    addLog(`Sent via Serial: ${command}`, 'sent');
                } else {
                    throw new Error('No active writable transport');
                }
            } catch (err) {
                addLog(`Failed to send "${command}": ${err.message}`, 'error');
            }
        }

        // ===== Arm connect / disconnect (application-level) =====
        // These send a handshake command to microcontroller that should reply with "Connected"
        async function armConnect() {
            if (!connectedVia) {
                addLog('No link to arm. Connect Bluetooth or Serial first.', 'error');
                return;
            }
            addLog('Attempting to connect to arm (sending CONNECT)...', 'info');
            await sendCommand('CONNECT');
            // Wait for microcontroller to respond with "Connected" (handled by readers)
            // We set isArmConnected=true optimistically after sending (can be overridden by incoming messages)
            isArmConnected = true;
            updateConnectionStatus();
        }

        async function armDisconnect() {
            if (!connectedVia) {
                addLog('No link to arm.', 'error');
                return;
            }
            addLog('Sending DISCONNECT to arm...', 'info');
            await sendCommand('DISCONNECT');
            isArmConnected = false;
            updateConnectionStatus();
        }

        // ===== UI interactions: sliders, presets, speed, system buttons =====
        // Helper to compute command: servoIndex 1..6
        function makeServoCommand(servoIndex, position) {
            // Clamp position to 0..180 for safety; but gripper slider already limited
            const pos = Math.max(0, Math.min(180, Math.round(Number(position))));
            return `s${servoIndex}${pos}`;
        }

        // Hook sliders
        document.querySelectorAll('.slider').forEach(slider => {
            slider.addEventListener('input', (e) => {
                const idx = Number(slider.dataset.index); // 1..6
                const pos = slider.value;
                const display = document.getElementById(`value${idx-1}`);
                if (display) display.textContent = `${pos}Â°`;
                // Send servo update if arm is connected
                if (isArmConnected) {
                    const cmd = makeServoCommand(idx, pos);
                    sendCommand(cmd);
                }
            });
        });

        // Hook preset buttons
        document.querySelectorAll('.preset-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const servoIdxZero = Number(btn.dataset.servo); // 0..5 (element index)
                const val = Number(btn.dataset.val);
                const slider = document.getElementById(`servo${servoIdxZero}`);
                if (slider) {
                    slider.value = val;
                    const idx = Number(slider.dataset.index); // 1..6
                    const display = document.getElementById(`value${idx-1}`);
                    if (display) display.textContent = `${val}Â°`;
                }
                // send if connected
                if (isArmConnected) {
                    const idx = servoIdxZero + 1;
                    sendCommand(makeServoCommand(idx, val));
                }
            });
        });

        // Speed control
        const speedSlider = document.getElementById('speedSlider');
        const speedValue = document.getElementById('speedValue');
        speedSlider.addEventListener('input', () => {
            const v = speedSlider.value;
            speedValue.textContent = v;
            if (isArmConnected) sendCommand(`ss${v}`);
        });

        // System control buttons
        document.getElementById('btnSave').addEventListener('click', () => { if (isArmConnected) sendCommand('SAVE'); });
        document.getElementById('btnRun').addEventListener('click', () => { if (isArmConnected) sendCommand('RUN'); });
        document.getElementById('btnReset').addEventListener('click', () => { if (isArmConnected) sendCommand('RESET'); });
        document.getElementById('btnPause').addEventListener('click', () => { if (isArmConnected) sendCommand('PAUSE'); });
        document.getElementById('btnResume').addEventListener('click', () => { if (isArmConnected) sendCommand('RESUME'); });

        // Keyboard shortcuts (Ctrl+S Save, Ctrl+R Run, Ctrl+H Reset)
        document.addEventListener('keydown', (ev) => {
            if (!ev.ctrlKey) return;
            if (ev.key === 's') { ev.preventDefault(); if (isArmConnected) sendCommand('SAVE'); }
            if (ev.key === 'r') { ev.preventDefault(); if (isArmConnected) sendCommand('RUN'); }
            if (ev.key === 'h') { ev.preventDefault(); if (isArmConnected) sendCommand('RESET'); }
        });

        // ===== Connect / disconnect UI actions =====
        btnConnectBT.addEventListener('click', async () => {
            await connectBluetooth();
            updateConnectionStatus();
        });

        btnConnectSerial.addEventListener('click', async () => {
            await connectSerial();
            updateConnectionStatus();
        });

        btnArmConnect.addEventListener('click', async () => {
            await armConnect();
        });

        btnArmDisconnect.addEventListener('click', async () => {
            await armDisconnect();
        });

        // When user closes page, tidy resources
        window.addEventListener('beforeunload', async () => {
            try {
                if (bluetoothDevice && bluetoothDevice.gatt && bluetoothDevice.gatt.connected) bluetoothDevice.gatt.disconnect();
            } catch (e) {}
            try { if (serialReader) await serialReader.cancel(); } catch (e){}
            try { if (serialPort) await serialPort.close(); } catch (e){}
        });

        // Initialize UI initial positions
        window.addEventListener('load', () => {
            const init = [0,90,90,90,90,90]; // gripper initial 90 per requested range
            for (let i=0;i<6;i++){
                const slider = document.getElementById(`servo${i}`);
                const display = document.getElementById(`value${i}`);
                if (slider) slider.value = init[i];
                if (display) display.textContent = `${init[i]}Â°`;
            }
            speedValue.textContent = speedSlider.value;
            setControlsEnabled(false);
            addLog('Interface initialized', 'info');
        });
    </script>
</body>
</html>
